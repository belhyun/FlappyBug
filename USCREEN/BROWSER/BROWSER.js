USCREEN.LAYER=CLASS({init:function(e,t,i,o){"use strict";var n,d,a,r,c,f,v,s,l,u,h,p,g,S,I,C,R,m,E,O,x,y,w,L,N,T=void 0!==o?o.img:void 0,W=void 0!==o&&void 0!==o.isOnCanvas?o.isOnCanvas:(void 0===BROWSER_CONFIG.USCREEN||BROWSER_CONFIG.USCREEN.isLayerOnCanvas===!0)&&INFO.checkIsSupportCanvas()===!0,z=void 0!==o?o.isHide:void 0,H=void 0!==o&&void 0!==o.left?o.left:0,F=void 0!==o&&void 0!==o.top?o.top:0,k=void 0!==o?o.zIndex:void 0,A=void 0!==o&&void 0!==o.clipLeft?o.clipLeft:0,D=void 0!==o&&void 0!==o.clipTop?o.clipTop:0,b=void 0!==o?o.clipWidth:void 0,U=void 0!==o?o.clipHeight:void 0,P=void 0!==o?o.width:void 0,V=void 0!==o?o.height:void 0,B=0,G=0,_=0,M=[],Y=[],X=[];W===!0?(i.addAfterRemoveProc=f=function(e){X.push(e)},i.getDiv=v=function(){},i.appendTo=s=function(t){return n=t,n.type===e?n.getChildren().push(i):n.addAfterRemoveProc(function(){u()}),i},i.getChildren=l=function(){return M},i.remove=u=function(){EACH(M,function(e){e.remove()}),EACH(X,function(e){e()}),REMOVE({data:n.getChildren(),value:i})},i.moveTo=h=function(e){void 0!==e.left&&(H=e.left),void 0!==e.top&&(F=e.top),void 0!==e.zIndex&&(k=e.zIndex)},i.hide=p=function(){z=!0},i.show=g=function(){z=!1},i.checkIsShow=S=function(){return z!==!0},i.turnLeft=I=function(){c=!1},i.turnRight=C=function(){c=!0},i.setImg=R=function(e){void 0!==T&&T.remove(),T=e},i.appendDom=m=function(e){Y.push(e),e.addStyle({position:"absolute"}),e.appendTo(BODY),e.addAfterRemoveProc(function(){REMOVE({data:Y,dom:e})})},i.findRealImgInfosForDraw=E=function(e){var t,i,o,n,d,a,r,f,v=e.left,s=e.top,l=e.degree,u=e.isRightSide,h=e.realImgInfos,p=e.rootLeft,g=e.rootTop,S=e.canvasScale;if(z!==!0){for(i=u===!0?c!==!0:c===!0,o=i===!0?-(v+H)-(void 0===b?void 0===T?0:T.getWidth():b):v+H,n=s+F,d=void 0===k?0:k,a=l+_,void 0!==T?(r={img:T,left:S*o,top:S*n,zIndex:d,degree:a,isRightSide:i,clipLeft:A,clipTop:D,clipWidth:b,clipHeight:U,width:S*(void 0===P?void 0===b?T.getWidth():b:P),height:S*(void 0===V?void 0===U?T.getHeight():U:V)},0!==a&&(r.centerLeft=S*(o+B),r.centerTop=S*(n+G))):r={zIndex:d},f=0;f<Y.length;f+=1)Y[f].addStyle({left:p+o,top:g+n});for(void 0!==k?r.childInfos=t=[]:t=h,h.push(r),f=0;f<M.length;f+=1)M[f].findRealImgInfosForDraw({left:o,top:n,degree:a,isRightSide:i,realImgInfos:t,rootLeft:p,rootTop:g,canvasScale:S})}},i.updateCanvas=O=function(){var e,t=[];void 0===d&&(d=n.getContext()),d.clear(),E({left:0,top:0,zIndex:0,degree:0,isRightSide:c,realImgInfos:t,rootLeft:n.getLeft(),rootTop:n.getTop(),canvasScale:n.getCanvasScale()}),(e=function(t){var i,o;for(t.sort(function(e,t){return e.zIndex-t.zIndex}),o=0;o<t.length;o+=1)i=t[o],void 0!==i.img&&(d.save(),i.isRightSide===!0&&d.setScale({scaleWidth:-1,scaleHeight:1}),0!==i.degree&&d.rotate(i),d.drawImg(i),d.restore()),void 0!==i.childInfos&&e(i.childInfos)})(t)},i.setClipLeft=x=function(e){A=e},i.setClipTop=y=function(e){D=e},i.setClipWidth=w=function(e){b=e},i.setClipHeight=L=function(e){U=e},i.rotate=N=function(e){B=e.centerLeft,G=e.centerTop,_=e.degree}):(a=DIV({style:{position:"absolute",left:H,top:F,zIndex:k,display:z===!0?"none":"block"}}),i.addAfterRemoveProc=f=function(e){a.addAfterRemoveProc(e)},f(function(){REMOVE({data:n.getChildren(),value:i})}),i.getDiv=v=function(){return a},i.appendTo=s=function(t){return n=t,n.type===e?(n.getChildren().push(i),n.getDiv().append(a)):n.append(a),i},i.getChildren=l=function(){return M},i.remove=u=function(){a.remove()},i.moveTo=h=function(e){void 0!==e.left&&(H=e.left),void 0!==e.top&&(F=e.top),void 0!==e.zIndex&&(k=parseInt(e.zIndex,10)),a.addStyle({left:H,top:F,zIndex:k})},i.hide=p=function(){z=!0,a.hide()},i.show=g=function(){z=!1,a.show()},i.checkIsShow=S=function(){return z!==!0},i.turnLeft=I=function(){c=!1,a.addStyle({transform:"none",filter:"none"})},i.turnRight=C=function(){c=!0,a.addStyle({transform:"scaleX(-1)",filter:"FlipH"})},i.setImg=R=function(e){void 0!==r&&(r.remove(),r=void 0),void 0!==T&&T.remove(),T=e,a.addStyle({width:void 0!==P?P:void 0===b?T.getWidth():b,height:void 0!==V?V:void 0===U?T.getHeight():U,background:"url("+T.getSrc()+")",backgroundRepeat:"no-repeat",backgroundPosition:-A+"px "+-D+"px",backgroundSize:(void 0!==P?P:T.getWidth())+"px "+(void 0!==V?V:T.getHeight())+"px"}),r=EVENT({node:T,name:"load"},function(){a.addStyle({width:void 0!==P?P:void 0===b?T.getWidth():b,height:void 0!==V?V:void 0===U?T.getHeight():U,backgroundSize:(void 0!==P?P:T.getWidth())+"px "+(void 0!==V?V:T.getHeight())+"px"}),r.remove(),r=void 0})},i.appendDom=m=function(e){e.addStyle({position:"absolute"}),a.append(e)},i.findRealImgInfosForDraw=E=function(){},i.updateCanvas=O=function(){},i.setClipLeft=x=function(e){A=e,a.addStyle({backgroundPosition:-A+"px "+-D+"px"})},i.setClipTop=y=function(e){D=e,a.addStyle({backgroundPosition:-A+"px "+-D+"px"})},i.setClipWidth=w=function(e){b=e,a.addStyle({width:b})},i.setClipHeight=L=function(e){U=e,a.addStyle({width:U})},i.rotate=N=function(e){B=e.centerLeft,G=e.centerTop,_=e.degree,a.addStyle({transformOrigin:B+"px "+G+"px",transform:"rotate("+_+"deg)"})}),void 0!==T&&R(T)}}),USCREEN.SURFACE=CLASS({preset:function(){"use strict";var e=(void 0===BROWSER_CONFIG.USCREEN||BROWSER_CONFIG.USCREEN.isLayerOnCanvas===!0)&&INFO.checkIsSupportCanvas()===!0;return e===!0?CANVAS:DIV},init:function(e,t,i,o){"use strict";var n,d,a,r,c,f=(void 0===BROWSER_CONFIG.USCREEN||BROWSER_CONFIG.USCREEN.isLayerOnCanvas===!0)&&INFO.checkIsSupportCanvas()===!0,v=INFO.checkIsSupportHD(),s=void 0===o||void 0===o.scale?1:o.scale,l=void 0===o||void 0===o.canvasScale?1:o.canvasScale;f===!0?(v===!0&&(l*=2),OVERRIDE({origin:i.setSize,func:function(e){i.setSize=a=function(t){n=t.width,d=t.height,e({width:n*l,height:d*l}),i.addStyle({width:n*s,height:d*s})}}}),1!==l&&i.getContext().setScale({scaleWidth:l,scaleHeight:l}),i.setScale=r=function(e){var t;return s=e,t={width:n*s,height:d*s},i.addStyle(t),t},i.getCanvasScale=c=function(){return l}):(i.setSize=a=function(e){n=e.width,d=e.height,i.addStyle({width:n,height:d})},i.setScale=r=function(e){return s=e,i.addStyle({transform:"scale("+s+","+s+")",transformOrigin:"0 0"}),{width:n*s,height:d*s}},i.addStyle({overflow:"hidden"}))}});